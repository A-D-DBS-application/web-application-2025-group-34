{% extends "logged_in_base.html" %}

{% block sub_content %}
<div class="card">
    <div class="section-head">
      <h3>Transacties Overzicht</h3>
      <button class="btn small" onclick="document.getElementById('addTransactionForm').style.display='block'">+ Transactie Toevoegen</button>
    </div>

    <div id="addTransactionForm" style="display:none; margin-top:20px; padding:20px; background:#f5f5f5; border-radius:8px;">
      <h3 style="margin-bottom:15px;">Nieuwe Transactie Toevoegen</h3>
      <form method="POST" action="{{ url_for('main.add_transaction') }}" class="inline-form">
        <div class="form-group">
          <label>Type *</label>
          <select name="transaction_type" required>
            <option value="BUY">BUY</option>
            <option value="SELL">SELL</option>
          </select>
        </div>
        <div class="form-group">
          <label>Datum</label>
          <input type="text" name="transaction_date" placeholder="dd/mm/yyyy (bijv. 01/09/2022)">
        </div>
        <div class="form-group">
          <label>Hoeveelheid</label>
          <input type="number" step="0.01" name="transaction_quantity" placeholder="Bijv. 10">
        </div>
        <div class="form-group">
          <label>Bedrag (€)</label>
          <input type="number" step="0.01" name="transaction_amount" placeholder="Bijv. 518.88">
        </div>
        <div class="form-actions">
          <button type="submit" class="btn">Toevoegen</button>
          <button type="button" class="btn ghost" onclick="document.getElementById('addTransactionForm').style.display='none'">Annuleren</button>
        </div>
      </form>
    </div>

    <table class="portfolio-table">
        <thead>
            <tr>
                <th>#</th>
                <th>Datum</th>
                <th>Type</th>
                <th>Asset</th>
                <th>Ticker</th>
                <th>Units</th>
                <th>Prijs</th>
                <th>Totaal (€)</th>
                <th>P&L (€)</th>
            </tr>
        </thead>
        <tbody>
            {% for t in transactions %}
            <tr>
                <td>{{ t.number }}</td>
                <td>{{ t.date }}</td>
                <td class="{% if t.type == 'BUY' %}positive{% else %}negative{% endif %}">{{ t.type }}</td>
                <td>{{ t.asset }}</td>
                <td class="ticker">{{ t.ticker }}</td>
                <td>{{ t.units }}</td>
                <td>€ {{ t.price }}</td>
                <td>€ {{ t.total }}</td>
                <td class="{% if t.profitLoss is not none and t.profitLoss >= 0 %}positive{% elif t.profitLoss is not none and t.profitLoss < 0 %}negative{% endif %}">
                    {% if t.profitLoss is not none %}
                        € {{ t.profitLoss | round(2) }}
                    {% else %}
                        -
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
</div>
{% endblock %}